<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMART</title>
  <!-- Vendor Stylesheets -->
  <!--<link href="./static/assets/css/reset.css" rel="stylesheet" type="text/css">-->
  <link rel="stylesheet" href="./static/assets/css2/plugins/bootstrap.min.css">
  <link rel="stylesheet" href="./static/assets/css2/plugins/animate.min.css">
  <!-- Icon Fonts -->
  <link rel="stylesheet" href="./static/assets/fonts/flaticon/flaticon.css">
  <link rel="stylesheet" href="./static/assets/css2/plugins/font-awesome.min.css">
  <!-- Tilakam Style sheet -->
  <link rel="stylesheet" href="./static/assets/css2/style.css">
  <link rel="stylesheet" href="./static/assets/css2/responsive.css">
  <link rel="stylesheet" href="./static/assets/css2/loading.css">
  <!-- MyStyle -->
  <!--<link rel="stylesheet" href="./static/assets/css2/mystyle.css">-->
  <link rel="stylesheet" href="./static/assets/css2/mystyle.css">
</head>

<body>



<!-- Header Start -->
<header class="sigma_header header-1 can-sticky header-absolute header-light">

  <!-- Middle Header Start -->
  <div class="sigma_header-middle">
    <div class="container">
      <nav class="navbar">

        <!-- Logo Start -->
        <div class="sigma_logo-wrapper">
          <a class="navbar-brand" href="index">
            <img src="./static/assets/img/SMART_logo2.svg" alt="logo">
          </a>
        </div>
        <!-- Logo End -->

        <ul class="navbar-nav">
          <li class="menu-item">
            <a href="index">Home</a>
          </li>
          <li class="menu-item menu-item-has-children">
            <a href="#">Browse</a>
            <ul class="sub-menu">
              <li class="menu-item">
                <a href="Browse_C">Molecule</a>
              </li>
              <li class="menu-item">
                <a href="Browse_P">Pathway</a>
              </li>
              <li class="menu-item">
                <a href="Browse_T">Target</a>
              </li>
            </ul>
          </li>
          <li class="menu-item menu-item-has-children">
            <a href="#">Search</a>
            <ul class="sub-menu">
              <li class="menu-item"> <a href="Search_text">Text</a> </li>
              <li class="menu-item"> <a href="Search_Structure">Structure</a> </li>
              <li class="menu-item"> <a href="Search_sequence">Sequence</a> </li>
            </ul>
          </li>
          <li class="menu-item menu-item-has-children">
            <a href="#">Download</a>
            <ul class="sub-menu">
              <li class="menu-item"> <a href="./static/download/SMILES.zip">2D structure files</a> </li>
              <li class="menu-item"> <a href="./static/download/mol2.zip">3D structure files</a> </li>
            </ul>
          </li>
          <li class="menu-item">
            <a href="greeting">Contribute</a>
          </li>
          <li class="menu-item">
            <a href="help">Help</a>
          </li>
          <li class="menu-item">
            <a href="citingus">Contact</a>
          </li>

        </ul>
      </nav>
    </div>
  </div>
  <!-- Middle Header End -->

</header>
<!-- Header End -->


  <!-- Banner Start -->
  <div class="sigma_banner banner-3" style="height: 105px;background-image: url('./static/assets/img/head-stat.png');">
  </div>

  <!-- 定义主体开始 -->
 <!-- 定义内容开始 -->
<div class="search-content">
  <div class="title">
    <img src="./static/assets/img/Search_sequence.svg" alt="">
  </div>
  <form  class="form1" id="form11" onsubmit="return saveReport2();">
    <p>Paste Amino Acid sequence (FASTA)</p>
    <textarea name="sequence_str" id="textarea" cols="30" rows="10"></textarea>
    <input type="submit" value="Search" id="sq_submit1">
    <!-- <button type="submit" value="search"></button> -->
  </form>
  <form  class="form2" id="form22"  onsubmit="return saveReport(); ">
  <P>Or upload files</P>
  <input id="lefile" type="file" style="display:none" name="sequence_file" onchange="jsReadFiles(this.files)" multiple accept=".fasta">
    <div class="input-append">
      <input id="photoCover" class="input-large" type="text">
      <a class="btn" onclick="$('input[id=lefile]').click();"></a>
    </div>
     <input type="submit" value="Search" id="sq_submit2">
  </form>
  <br>
  <br>
  <label class="radio inline">
    Matrix:&nbsp;&nbsp;&nbsp;&nbsp;
  </label>
  <select name="selectMartix" id="selectMartix">
    <option value="BLOSUM45">BLOSUM45</option>
    <option value="BLOSUM50">BLOSUM50</option>
    <option value="BLOSUM62" selected>BLOSUM62</option>
    <option value="BLOSUM80">BLOSUM80</option>
    <option value="BLOSUM90">BLOSUM90</option>
    <option value="PAM30">PAM30</option>
    <option value="PAM70">PAM70</option>
    <option value="PAM250">PAM250</option>
    <option value="IDENTITY">IDENTITY</option>
  </select>
  <!--<label class="radio inline">
    <input type="radio" name="matixRadio" id="optionsRadios1" value="BLOSUM50" checked>
    BLOSUM50
  </label>
  &nbsp;&nbsp;&nbsp;&nbsp;
  <label class="radio inline">
    <input type="radio" name="matixRadio" id="optionsRadios2" value="BLOSUM62" >
    BLOSUM62
  </label>
  &nbsp;&nbsp;&nbsp;&nbsp;
  <label class="radio inline">
    <input type="radio" name="matixRadio" id="optionsRadios3" value="PAM10" >
    PAM10
  </label>
  &nbsp;&nbsp;&nbsp;&nbsp;
  <label class="radio inline">
    <input type="radio" name="matixRadio" id="optionsRadios4" value="PAM250" >
    PAM250
  </label>-->
  &nbsp;&nbsp;&nbsp;&nbsp;
  <label class="radio inline">
    e-value:&nbsp;&nbsp;&nbsp;&nbsp;
  </label>
  &nbsp;&nbsp;
  <select name="selectVaule" id="selectValue">
    <option value="0.05">0.05</option>
    <option value="1" selected>1</option>
    <option value="10">10</option>
  </select>
</div>
<!-- 定义主体结束 -->

<footer class="sigma_footer sigma_footer-dark">

  <!-- Middle Footer -->
  <div class="sigma_footer-middle">
    <div class="container">
      <div class="row">
        <div class="col-xl-3 col-lg-3 col-md-4 col-sm-12 footer-widget">
          <img src="./static/assets/img/SMART_logo2.svg" class="mb-4" alt="logo">
          <p>The Ma Laboratory School of Life Sciences, Northwest A&F University, Yangling, Shaanxi, 712100, China</p>
          <!--<p>Room No.2216, State Key Laboratory of Crop Stress Biology for Arid Areas</p>-->
        </div>
        <div class="col-xl-4 col-lg-3 col-md-4 col-sm-12 footer-widget">
          <h5 class="widget-title">Information</h5>
          <ul>
            <li> <a href="index">Home</a> </li>
            <li> <a href="greeting">Contribute</a> </li>
            <li> <a href="./static/download/SMILES.zip">2D structure files</a> </li>
            <li> <a href="./static/download/mol2.zip">3D structure files</a> </li>
            <li> <a href="help">Help</a> </li>
            <li> <a href="citingus">Contact</a> </li>

          </ul>
        </div>

        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 d-none d-lg-block footer-widget">
          <h5 class="widget-title">About Us</h5>
          <ul>
            <li> <a href="https://bioinfo.nwafu.edu.cn/" target="_blank">MaLab</a> </li>
            <li> <a href="https://scholar.google.com/citations?user=UaWkSkIAAAAJ&hl=en" target="_blank">Google Scholar</a> </li>
            <li> <a href="https://github.com/cma2015" target="_blank">Github </a></li>
            <li> <a href="mailto:chuangma2006@gmail.com">Gmail</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer Bottom -->
  <div class="sigma_footer-bottom">
    <div class="container">
      <div class="sigma_footer-copyright">
        <p> Copyright © 2020. All Rights Reserved. </p>
      </div>
    </div>
  </div>

</footer>
<!-- Footer End -->

  <!-- Vendor Scripts -->
  <script src="./static/assets/js2/plugins/jquery-3.4.1.min.js"></script>
  <script src="./static/assets/js2/plugins/popper.min.js"></script>
  <script src="./static/assets/js2/plugins/bootstrap.min.js"></script>
  <script src="./static/assets/js2/plugins/imagesloaded.min.js"></script>
  <script src="./static/assets/js2/plugins/jquery.magnific-popup.min.js"></script>


  <script src="./static/assets/js2/plugins/jquery.countdown.min.js"></script>
  <script src="./static/assets/js2/plugins/jquery.waypoints.min.js"></script>
  <script src="./static/assets/js2/plugins/jquery.counterup.min.js"></script>
  <script src="./static/assets/js2/plugins/jquery.zoom.min.js"></script>
  <script src="./static/assets/js2/plugins/jquery.inview.min.js"></script>
  <script src="./static/assets/js2/plugins/jquery.event.move.js"></script>

  <script src="./static/assets/js2/plugins/wow.min.js"></script>
  <script src="./static/assets/js2/plugins/isotope.pkgd.min.js"></script>
  <script src="./static/assets/js2/plugins/slick.min.js"></script>
  <script src="./static/assets/js2/plugins/ion.rangeSlider.min.js"></script>
  <script src="./static/assets/js2/loading.js"></script>
  <!-- Tilakam Scripts -->
  <script src="./static/assets/js2/main.js"></script>
  <script type="text/javascript">
$('input[id=lefile]').change(function() {
    $('#photoCover').val($(this).val());
});

let formData;
function jsReadFiles(files) {

        if (files.length) {
            var file = files[0];
      // var reader = new FileReader();//new一个FileReader实例
          //
      formData = new FormData();
      //var martix = $('input[type=radio][name=matixRadio]:checked').val();
      var opt_value = $("#selectValue option:selected").val();
      var martix = $("#selectMartix option:selected").val();
      formData.set('file',file);
      formData.set('martix',martix);
      formData.set('evalue',opt_value);
      console.log(file)
      // alert(formData)
            // if (/text+/.test(file.type)) {//判断文件类型，是不是text类型
                // reader.onload = function() {
        //  // $('body').append('<pre>' + this.result + '</pre>');
        //  console.log(this.result);
                // }
        // reader.readAsText(file);
        // console.log(reader.result);
        }
  }
// 文件提交
function saveReport(){
  //console.log(formData);
  //console.log(formData.get("file"))
  loading1();
  $.ajax({
      url: "http://39.101.176.205:4010/SMART/seqSearchByFile",
      type: "post",
      async: true,
      dataType : 'json',
      // jsonp:'callback',
      processData: false,
      data:formData,
      contentType: false,
      success: function(data){
        console.log(data);
        var sequence_result = window.btoa(JSON.stringify(data));
        console.log(data);
        window.location.href = "Search_sequence_result?sequence_result="+sequence_result;
      }
    })
    return false;
}

// 文本查询
function saveReport2(){
  loading1();
  var sequence_str = $("#textarea").val();
  //var martix = $('input[type=radio][name=matixRadio]:checked').val();
  var martix = $("#selectMartix option:selected").val();
  var opt_value = $("#selectValue option:selected").val();
  console.log(sequence_str);

    $.ajax({
      url: "http://39.101.176.205:4010/SMART/seqSearchByStr?callback=?",
      type: "get",
      async: true,
      dataType : 'jsonp',
      jsonp:'callback',
      data:{
        "sequence":sequence_str,
        "martix":martix,
        "evalue":opt_value
      },
      contentType:'application/json',
      success: function(data){
        console.log("success"+data);
        // console.log(sequence_str);
        // alert(data)
        var sequence_result = window.btoa(JSON.stringify(data));
        console.log("sequence_result"+sequence_result);
        window.location.href = "Search_sequence_result?sequence_result="+sequence_result;
        // console.log(data);
      //    var obj_1={
        //  obj_box:'.page',//翻页容器
        // };
        // page_ctrl2(obj_1,data);
      }

    })
  return false;
}
// $('#submit1').click(function() {
//     var d = {};
//     var t = $('#form11').serializeArray();
//     //t的值为[{name: "a1", value: "xx"},
//     //{name: "a2", value: "xx"}...]
//     $.each(t, function() {
//       d[this.name] = this.value;
//     });
//     // alert(JSON.stringify(d));
//  let sequence = JSON.stringify(d);
//  console.log(sequence);
//  $("#form11").submit(function(e){
//      e.preventDefault();
//      alert("Submit prevented");
//   });

//  $.ajax({
//      url: "http://39.106.216.153:8080/SMART-0.0.1-SNAPSHOT/keywordSearch?callback=?",
//      type: "post",
//      async: true,
//      dataType : 'jsonp',
//      jsonp:'callback',
//      data:sequence,
//      contentType:'application/json',
//      success: function(data){
//        console.log(data);    
//      }

//    })



//   });
// // //   文件查询
// // $('#submit2').click(function() {
// //     var d = {};
// //     var t = $('#form22').serializeArray();
// //     //t的值为[{name: "a1", value: "xx"},
// //     //{name: "a2", value: "xx"}...]
// //     $.each(t, function() {
// //       d[this.name] = this.value;
// //     });
// //     alert(JSON.stringify(d));
// //   });
function loading1() {
  $('body').loading({
    loadingWidth:240,
    title:'Loading!',
    name:'test',
    discription:'process of calculation',
    direction:'column',
    type:'origin',
    // originBg:'#71EA71',
    originDivWidth:40,
    originDivHeight:40,
    originWidth:6,
    originHeight:6,
    smallLoading:false,
    loadingMaskBg:'rgba(0,0,0,0.2)'
  });

}

</script>
</body>

</html>
